<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1e3a8a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="clientGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#10b981;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ef4444;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <dropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8fafc"/>

  <!-- Header -->
  <rect x="0" y="0" width="1200" height="80" fill="url(#headerGrad)"/>
  <text x="600" y="50" text-anchor="middle" fill="white" font-size="28" font-weight="bold">SSL/TLS Handshake Protocol - Detailed Implementation</text>

  <!-- Client and Server Headers -->
  <rect x="50" y="100" width="480" height="50" fill="url(#clientGrad)" rx="10" filter="url(#shadow)"/>
  <text x="290" y="135" text-anchor="middle" fill="white" font-size="20" font-weight="bold">Client</text>

  <rect x="670" y="100" width="480" height="50" fill="url(#serverGrad)" rx="10" filter="url(#shadow)"/>
  <text x="910" y="135" text-anchor="middle" fill="white" font-size="20" font-weight="bold">Server</text>

  <!-- Handshake Steps -->

  <!-- Step 1: Client Hello -->
  <rect x="60" y="180" width="460" height="90" fill="#ecfdf5" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="70" y="205" fill="#065f46" font-size="16" font-weight="bold">1. Client Hello</text>
  <text x="70" y="225" fill="#374151" font-size="12">• Supported cipher suites</text>
  <text x="70" y="240" fill="#374151" font-size="12">• Random number (28 bytes)</text>
  <text x="70" y="255" fill="#374151" font-size="12">• Session ID (if resuming)</text>

  <!-- Arrow 1 -->
  <path d="M 520 225 L 670 225" stroke="#059669" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <text x="595" y="215" text-anchor="middle" fill="#059669" font-size="12" font-weight="bold">Client Hello</text>

  <!-- Step 2: Server Hello -->
  <rect x="680" y="180" width="460" height="90" fill="#fef2f2" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="690" y="205" fill="#7f1d1d" font-size="16" font-weight="bold">2. Server Hello</text>
  <text x="690" y="225" fill="#374151" font-size="12">• Selected cipher suite</text>
  <text x="690" y="240" fill="#374151" font-size="12">• Server random (28 bytes)</text>
  <text x="690" y="255" fill="#374151" font-size="12">• Session ID</text>

  <!-- Arrow 2 -->
  <path d="M 670 300 L 520 300" stroke="#dc2626" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
  <text x="595" y="290" text-anchor="middle" fill="#dc2626" font-size="12" font-weight="bold">Server Hello</text>

  <!-- Step 3: Certificate -->
  <rect x="680" y="320" width="460" height="70" fill="#fef2f2" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="690" y="345" fill="#7f1d1d" font-size="16" font-weight="bold">3. Certificate</text>
  <text x="690" y="365" fill="#374151" font-size="12">• X.509 certificate with public key</text>
  <text x="690" y="380" fill="#374151" font-size="12">• Certificate chain validation</text>

  <!-- Arrow 3 -->
  <path d="M 670 355 L 520 355" stroke="#dc2626" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
  <text x="595" y="345" text-anchor="middle" fill="#dc2626" font-size="12" font-weight="bold">Certificate</text>

  <!-- Step 4: Server Hello Done -->
  <rect x="680" y="410" width="460" height="50" fill="#fef2f2" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="690" y="435" fill="#7f1d1d" font-size="16" font-weight="bold">4. Server Hello Done</text>
  <text x="690" y="450" fill="#374151" font-size="12">• Server finished sending hello messages</text>

  <!-- Arrow 4 -->
  <path d="M 670 435 L 520 435" stroke="#dc2626" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
  <text x="595" y="425" text-anchor="middle" fill="#dc2626" font-size="12" font-weight="bold">Server Hello Done</text>

  <!-- Step 5: Client Key Exchange -->
  <rect x="60" y="480" width="460" height="70" fill="#ecfdf5" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="70" y="505" fill="#065f46" font-size="16" font-weight="bold">5. Client Key Exchange</text>
  <text x="70" y="525" fill="#374151" font-size="12">• Pre-master secret encrypted with server public key</text>
  <text x="70" y="540" fill="#374151" font-size="12">• 48-byte random value for master secret</text>

  <!-- Arrow 5 -->
  <path d="M 520 515 L 670 515" stroke="#059669" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <text x="595" y="505" text-anchor="middle" fill="#059669" font-size="12" font-weight="bold">Client Key Exchange</text>

  <!-- Step 6: Change Cipher Spec -->
  <rect x="60" y="570" width="460" height="50" fill="#ecfdf5" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="70" y="595" fill="#065f46" font-size="16" font-weight="bold">6. Change Cipher Spec</text>
  <text x="70" y="610" fill="#374151" font-size="12">• Activate negotiated cipher suite</text>

  <!-- Arrow 6 -->
  <path d="M 520 595 L 670 595" stroke="#059669" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <text x="595" y="585" text-anchor="middle" fill="#059669" font-size="12" font-weight="bold">Change Cipher Spec</text>

  <!-- Step 7: Finished (Client) -->
  <rect x="60" y="640" width="460" height="50" fill="#ecfdf5" stroke="#10b981" stroke-width="2" rx="8"/>
  <text x="70" y="665" fill="#065f46" font-size="16" font-weight="bold">7. Finished (Client)</text>
  <text x="70" y="680" fill="#374151" font-size="12">• Encrypted handshake verification</text>

  <!-- Arrow 7 -->
  <path d="M 520 665 L 670 665" stroke="#059669" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <text x="595" y="655" text-anchor="middle" fill="#059669" font-size="12" font-weight="bold">Finished</text>

  <!-- Step 8: Change Cipher Spec (Server) -->
  <rect x="680" y="710" width="460" height="50" fill="#fef2f2" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="690" y="735" fill="#7f1d1d" font-size="16" font-weight="bold">8. Change Cipher Spec</text>
  <text x="690" y="750" fill="#374151" font-size="12">• Server activates cipher suite</text>

  <!-- Arrow 8 -->
  <path d="M 670 735 L 520 735" stroke="#dc2626" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
  <text x="595" y="725" text-anchor="middle" fill="#dc2626" font-size="12" font-weight="bold">Change Cipher Spec</text>

  <!-- Step 9: Finished (Server) -->
  <rect x="680" y="780" width="460" height="50" fill="#fef2f2" stroke="#ef4444" stroke-width="2" rx="8"/>
  <text x="690" y="805" fill="#7f1d1d" font-size="16" font-weight="bold">9. Finished (Server)</text>
  <text x="690" y="820" fill="#374151" font-size="12">• Server handshake complete</text>

  <!-- Arrow 9 -->
  <path d="M 670 805 L 520 805" stroke="#dc2626" stroke-width="3" fill="none" marker-end="url(#arrowhead2)"/>
  <text x="595" y="795" text-anchor="middle" fill="#dc2626" font-size="12" font-weight="bold">Finished</text>

  <!-- Connection Established -->
  <rect x="400" y="850" width="400" height="40" fill="#fbbf24" stroke="#f59e0b" stroke-width="2" rx="20"/>
  <text x="600" y="875" text-anchor="middle" fill="#92400e" font-size="16" font-weight="bold">Secure Connection Established</text>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669"/>
    </marker>
    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dc2626"/>
    </marker>
  </defs>
</svg>