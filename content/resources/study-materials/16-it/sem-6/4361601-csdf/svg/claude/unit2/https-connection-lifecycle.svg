<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; text-anchor: middle; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #34495e; text-anchor: middle; }
      .section-title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: white; text-anchor: middle; }
      .step-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .step-text { font-family: Arial, sans-serif; font-size: 11px; fill: #34495e; }
      .initiation-header { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .handshake-header { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .data-header { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .closure-header { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .step-box { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 1; }
      .flow-bg { fill: #f8f9fa; stroke: #6c757d; stroke-width: 1; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .client-box { fill: #e8f4fd; stroke: #3498db; stroke-width: 1; }
      .server-box { fill: #e8f5e8; stroke: #27ae60; stroke-width: 1; }
      .security-box { fill: #fff3e0; stroke: #f39c12; stroke-width: 1; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="800" fill="#ffffff"/>

  <!-- Title -->
  <text x="600" y="30" class="title">HTTPS Connection Lifecycle: Initiation and Closure</text>
  <text x="600" y="50" class="subtitle">Complete SSL/TLS Handshake Process and Secure Communication Flow</text>

  <!-- Connection Initiation Phase -->
  <rect x="50" y="80" width="280" height="320" class="initiation-header" rx="10"/>
  <text x="190" y="105" class="section-title">Connection Initiation</text>

  <!-- Step 1: Client Hello -->
  <rect x="70" y="120" width="240" height="65" class="step-box" rx="5"/>
  <text x="80" y="140" class="step-title">1. Client Hello</text>
  <text x="80" y="155" class="step-text">• TLS version supported</text>
  <text x="80" y="168" class="step-text">• Cipher suites list</text>
  <text x="80" y="181" class="step-text">• Random number generation</text>

  <!-- Step 2: Server Hello -->
  <rect x="70" y="195" width="240" height="65" class="step-box" rx="5"/>
  <text x="80" y="215" class="step-title">2. Server Hello</text>
  <text x="80" y="230" class="step-text">• Selected TLS version</text>
  <text x="80" y="243" class="step-text">• Selected cipher suite</text>
  <text x="80" y="256" class="step-text">• Server random number</text>

  <!-- Step 3: Certificate -->
  <rect x="70" y="270" width="240" height="65" class="step-box" rx="5"/>
  <text x="80" y="290" class="step-title">3. Server Certificate</text>
  <text x="80" y="305" class="step-text">• X.509 certificate</text>
  <text x="80" y="318" class="step-text">• Public key included</text>
  <text x="80" y="331" class="step-text">• Certificate chain</text>

  <!-- Step 4: Key Exchange -->
  <rect x="70" y="345" width="240" height="45" class="step-box" rx="5"/>
  <text x="80" y="365" class="step-title">4. Key Exchange</text>
  <text x="80" y="380" class="step-text">• Pre-master secret generation</text>

  <!-- TLS Handshake Details -->
  <rect x="350" y="80" width="280" height="320" class="handshake-header" rx="10"/>
  <text x="490" y="105" class="section-title">TLS Handshake Process</text>

  <!-- Certificate Verification -->
  <rect x="370" y="120" width="240" height="65" class="step-box" rx="5"/>
  <text x="380" y="140" class="step-title">Certificate Verification</text>
  <text x="380" y="155" class="step-text">• Check certificate validity</text>
  <text x="380" y="168" class="step-text">• Verify certificate chain</text>
  <text x="380" y="181" class="step-text">• Validate hostname</text>

  <!-- Key Generation -->
  <rect x="370" y="195" width="240" height="65" class="step-box" rx="5"/>
  <text x="380" y="215" class="step-title">Session Key Generation</text>
  <text x="380" y="230" class="step-text">• Pre-master secret encryption</text>
  <text x="380" y="243" class="step-text">• Master secret derivation</text>
  <text x="380" y="256" class="step-text">• Session keys calculation</text>

  <!-- Finished Messages -->
  <rect x="370" y="270" width="240" height="65" class="step-box" rx="5"/>
  <text x="380" y="290" class="step-title">Handshake Completion</text>
  <text x="380" y="305" class="step-text">• Client finished message</text>
  <text x="380" y="318" class="step-text">• Server finished message</text>
  <text x="380" y="331" class="step-text">• Handshake verification</text>

  <!-- Secure Channel -->
  <rect x="370" y="345" width="240" height="45" class="step-box" rx="5"/>
  <text x="380" y="365" class="step-title">Secure Channel Established</text>
  <text x="380" y="380" class="step-text">• Encrypted communication ready</text>

  <!-- Data Transmission -->
  <rect x="650" y="80" width="280" height="320" class="data-header" rx="10"/>
  <text x="790" y="105" class="section-title">Secure Data Transfer</text>

  <!-- Application Data -->
  <rect x="670" y="120" width="240" height="65" class="step-box" rx="5"/>
  <text x="680" y="140" class="step-title">Application Data Encryption</text>
  <text x="680" y="155" class="step-text">• AES symmetric encryption</text>
  <text x="680" y="168" class="step-text">• Message authentication</text>
  <text x="680" y="181" class="step-text">• Sequence number tracking</text>

  <!-- Record Protocol -->
  <rect x="670" y="195" width="240" height="65" class="step-box" rx="5"/>
  <text x="680" y="215" class="step-title">TLS Record Protocol</text>
  <text x="680" y="230" class="step-text">• Fragmentation</text>
  <text x="680" y="243" class="step-text">• Compression (optional)</text>
  <text x="680" y="256" class="step-text">• MAC computation</text>

  <!-- Error Handling -->
  <rect x="670" y="270" width="240" height="65" class="step-box" rx="5"/>
  <text x="680" y="290" class="step-title">Error Handling</text>
  <text x="680" y="305" class="step-text">• Alert messages</text>
  <text x="680" y="318" class="step-text">• Fatal vs warning alerts</text>
  <text x="680" y="331" class="step-text">• Connection recovery</text>

  <!-- Session Management -->
  <rect x="670" y="345" width="240" height="45" class="step-box" rx="5"/>
  <text x="680" y="365" class="step-title">Session Management</text>
  <text x="680" y="380" class="step-text">• Session resumption support</text>

  <!-- Connection Closure -->
  <rect x="950" y="80" width="200" height="320" class="closure-header" rx="10"/>
  <text x="1050" y="105" class="section-title">Connection Closure</text>

  <!-- Graceful Closure -->
  <rect x="970" y="120" width="160" height="65" class="step-box" rx="5"/>
  <text x="980" y="140" class="step-title">Graceful Closure</text>
  <text x="980" y="155" class="step-text">• Close notify alert</text>
  <text x="980" y="168" class="step-text">• Bidirectional closure</text>
  <text x="980" y="181" class="step-text">• Session termination</text>

  <!-- Abrupt Closure -->
  <rect x="970" y="195" width="160" height="65" class="step-box" rx="5"/>
  <text x="980" y="215" class="step-title">Abrupt Closure</text>
  <text x="980" y="230" class="step-text">• Fatal alert messages</text>
  <text x="980" y="243" class="step-text">• Connection reset</text>
  <text x="980" y="256" class="step-text">• Error conditions</text>

  <!-- Session Cache -->
  <rect x="970" y="270" width="160" height="65" class="step-box" rx="5"/>
  <text x="980" y="290" class="step-title">Session Cache</text>
  <text x="980" y="305" class="step-text">• Session ID storage</text>
  <text x="980" y="318" class="step-text">• Resume capability</text>
  <text x="980" y="331" class="step-text">• Timeout management</text>

  <!-- Cleanup -->
  <rect x="970" y="345" width="160" height="45" class="step-box" rx="5"/>
  <text x="980" y="365" class="step-title">Resource Cleanup</text>
  <text x="980" y="380" class="step-text">• Memory deallocation</text>

  <!-- Detailed Communication Flow -->
  <rect x="50" y="420" width="1100" height="320" class="flow-bg" rx="10"/>
  <text x="600" y="445" class="title" style="font-size: 20px;">HTTPS Communication Flow Diagram</text>

  <!-- Client side -->
  <text x="200" y="475" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Client (Browser)</text>
  <line x1="200" y1="485" x2="200" y2="700" stroke="#3498db" stroke-width="3"/>

  <!-- Server side -->
  <text x="800" y="475" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Server (Web Server)</text>
  <line x1="800" y1="485" x2="800" y2="700" stroke="#27ae60" stroke-width="3"/>

  <!-- Message exchanges -->
  <g style="font-family: Arial; font-size: 11px;">
    <!-- Client Hello -->
    <rect x="220" y="495" width="150" height="20" class="client-box" rx="3"/>
    <text x="225" y="508">1. Client Hello</text>
    <line x1="370" y1="505" x2="795" y2="505" class="arrow"/>

    <!-- Server Hello -->
    <rect x="630" y="515" width="150" height="20" class="server-box" rx="3"/>
    <text x="635" y="528">2. Server Hello</text>
    <line x1="625" y1="525" x2="205" y2="525" class="arrow"/>

    <!-- Certificate -->
    <rect x="630" y="535" width="150" height="20" class="server-box" rx="3"/>
    <text x="635" y="548">3. Certificate</text>
    <line x1="625" y1="545" x2="205" y2="545" class="arrow"/>

    <!-- Server Hello Done -->
    <rect x="630" y="555" width="150" height="20" class="server-box" rx="3"/>
    <text x="635" y="568">4. Server Hello Done</text>
    <line x1="625" y1="565" x2="205" y2="565" class="arrow"/>

    <!-- Client Key Exchange -->
    <rect x="220" y="575" width="150" height="20" class="client-box" rx="3"/>
    <text x="225" y="588">5. Client Key Exchange</text>
    <line x1="370" y1="585" x2="795" y2="585" class="arrow"/>

    <!-- Change Cipher Spec -->
    <rect x="220" y="595" width="150" height="20" class="client-box" rx="3"/>
    <text x="225" y="608">6. Change Cipher Spec</text>
    <line x1="370" y1="605" x2="795" y2="605" class="arrow"/>

    <!-- Client Finished -->
    <rect x="220" y="615" width="150" height="20" class="client-box" rx="3"/>
    <text x="225" y="628">7. Finished</text>
    <line x1="370" y1="625" x2="795" y2="625" class="arrow"/>

    <!-- Server Change Cipher Spec -->
    <rect x="630" y="635" width="150" height="20" class="server-box" rx="3"/>
    <text x="635" y="648">8. Change Cipher Spec</text>
    <line x1="625" y1="645" x2="205" y2="645" class="arrow"/>

    <!-- Server Finished -->
    <rect x="630" y="655" width="150" height="20" class="server-box" rx="3"/>
    <text x="635" y="668">9. Finished</text>
    <line x1="625" y1="665" x2="205" y2="665" class="arrow"/>

    <!-- Application Data -->
    <rect x="400" y="685" width="200" height="20" class="security-box" rx="3"/>
    <text x="500" y="698" style="text-anchor: middle;">Encrypted Application Data Exchange</text>
    <line x1="370" y1="695" x2="630" y2="695" stroke="#f39c12" stroke-width="2" stroke-dasharray="5,5"/>
    <line x1="630" y1="705" x2="370" y2="705" stroke="#f39c12" stroke-width="2" stroke-dasharray="5,5"/>
  </g>

  <!-- Security Features -->
  <text x="150" y="730" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Security Features:</text>
  <text x="150" y="745" style="font-family: Arial; font-size: 12px; fill: #34495e;">• Forward Secrecy</text>
  <text x="150" y="760" style="font-family: Arial; font-size: 12px; fill: #34495e;">• Certificate Validation</text>

  <text x="350" y="730" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Cipher Suites:</text>
  <text x="350" y="745" style="font-family: Arial; font-size: 12px; fill: #34495e;">• TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</text>
  <text x="350" y="760" style="font-family: Arial; font-size: 12px; fill: #34495e;">• TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</text>

  <text x="750" y="730" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Protocol Versions:</text>
  <text x="750" y="745" style="font-family: Arial; font-size: 12px; fill: #34495e;">• TLS 1.3 (Recommended)</text>
  <text x="750" y="760" style="font-family: Arial; font-size: 12px; fill: #34495e;">• TLS 1.2 (Acceptable)</text>

  <text x="950" y="730" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Performance:</text>
  <text x="950" y="745" style="font-family: Arial; font-size: 12px; fill: #34495e;">• Session Resumption</text>
  <text x="950" y="760" style="font-family: Arial; font-size: 12px; fill: #34495e;">• HTTP/2 Multiplexing</text>

  <!-- Footer -->
  <text x="600" y="785" class="subtitle">HTTPS ensures secure web communication through robust encryption, authentication, and integrity verification</text>
</svg>