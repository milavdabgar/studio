<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; text-anchor: middle; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #34495e; text-anchor: middle; }
      .section-title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: white; text-anchor: middle; }
      .step-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .step-text { font-family: Arial, sans-serif; font-size: 11px; fill: #34495e; }
      .key-header { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .encryption-header { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .decryption-header { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .feistel-header { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .step-box { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 1; }
      .flow-bg { fill: #f8f9fa; stroke: #6c757d; stroke-width: 1; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .data-box { fill: #e8f4fd; stroke: #3498db; stroke-width: 1; }
      .key-box { fill: #fde8e8; stroke: #e74c3c; stroke-width: 1; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="800" fill="#ffffff"/>

  <!-- Title -->
  <text x="600" y="30" class="title">DES (Data Encryption Standard) Algorithm Structure</text>
  <text x="600" y="50" class="subtitle">56-bit Key Block Cipher with Feistel Network Architecture</text>

  <!-- Key Schedule -->
  <rect x="50" y="80" width="270" height="280" class="key-header" rx="10"/>
  <text x="185" y="105" class="section-title">Key Schedule</text>

  <!-- Initial Key Processing -->
  <rect x="70" y="120" width="230" height="50" class="step-box" rx="5"/>
  <text x="80" y="140" class="step-title">1. Initial Key (64 bits)</text>
  <text x="80" y="155" class="step-text">• Input: 64-bit key with 8 parity bits</text>
  <text x="80" y="168" class="step-text">• Effective key length: 56 bits</text>

  <!-- PC-1 Permutation -->
  <rect x="70" y="180" width="230" height="50" class="step-box" rx="5"/>
  <text x="80" y="200" class="step-title">2. PC-1 Permutation</text>
  <text x="80" y="215" class="step-text">• Removes parity bits</text>
  <text x="80" y="228" class="step-text">• Produces 56-bit permuted key</text>

  <!-- Split into C0 and D0 -->
  <rect x="70" y="240" width="230" height="50" class="step-box" rx="5"/>
  <text x="80" y="260" class="step-title">3. Split into C0 and D0</text>
  <text x="80" y="275" class="step-text">• C0: Left 28 bits</text>
  <text x="80" y="288" class="step-text">• D0: Right 28 bits</text>

  <!-- Round Key Generation -->
  <rect x="70" y="300" width="230" height="50" class="step-box" rx="5"/>
  <text x="80" y="320" class="step-title">4. 16 Round Keys</text>
  <text x="80" y="335" class="step-text">• Left shifts by 1 or 2 positions</text>
  <text x="80" y="348" class="step-text">• PC-2 permutation (48 bits each)</text>

  <!-- Encryption Process -->
  <rect x="340" y="80" width="270" height="280" class="encryption-header" rx="10"/>
  <text x="475" y="105" class="section-title">Encryption Process</text>

  <!-- Initial Permutation -->
  <rect x="360" y="120" width="230" height="50" class="step-box" rx="5"/>
  <text x="370" y="140" class="step-title">1. Initial Permutation (IP)</text>
  <text x="370" y="155" class="step-text">• 64-bit input block</text>
  <text x="370" y="168" class="step-text">• Fixed permutation table</text>

  <!-- Split into L0 and R0 -->
  <rect x="360" y="180" width="230" height="50" class="step-box" rx="5"/>
  <text x="370" y="200" class="step-title">2. Split into L0 and R0</text>
  <text x="370" y="215" class="step-text">• L0: Left 32 bits</text>
  <text x="370" y="228" class="step-text">• R0: Right 32 bits</text>

  <!-- 16 Rounds -->
  <rect x="360" y="240" width="230" height="50" class="step-box" rx="5"/>
  <text x="370" y="260" class="step-title">3. 16 Feistel Rounds</text>
  <text x="370" y="275" class="step-text">• Li = Ri-1</text>
  <text x="370" y="288" class="step-text">• Ri = Li-1 ⊕ f(Ri-1, Ki)</text>

  <!-- Final Permutation -->
  <rect x="360" y="300" width="230" height="50" class="step-box" rx="5"/>
  <text x="370" y="320" class="step-title">4. Final Permutation (IP-1)</text>
  <text x="370" y="335" class="step-text">• Inverse of initial permutation</text>
  <text x="370" y="348" class="step-text">• Produces 64-bit ciphertext</text>

  <!-- Feistel Function -->
  <rect x="630" y="80" width="270" height="280" class="feistel-header" rx="10"/>
  <text x="765" y="105" class="section-title">Feistel Function f(R,K)</text>

  <!-- Expansion -->
  <rect x="650" y="120" width="230" height="50" class="step-box" rx="5"/>
  <text x="660" y="140" class="step-title">1. Expansion (E)</text>
  <text x="660" y="155" class="step-text">• 32 bits → 48 bits</text>
  <text x="660" y="168" class="step-text">• Duplication and permutation</text>

  <!-- XOR with Round Key -->
  <rect x="650" y="180" width="230" height="50" class="step-box" rx="5"/>
  <text x="660" y="200" class="step-title">2. XOR with Round Key</text>
  <text x="660" y="215" class="step-text">• E(R) ⊕ K (48 bits)</text>
  <text x="660" y="228" class="step-text">• Key mixing operation</text>

  <!-- S-Box Substitution -->
  <rect x="650" y="240" width="230" height="50" class="step-box" rx="5"/>
  <text x="660" y="260" class="step-title">3. S-Box Substitution</text>
  <text x="660" y="275" class="step-text">• 8 S-boxes (6→4 bits each)</text>
  <text x="660" y="288" class="step-text">• 48 bits → 32 bits</text>

  <!-- Permutation -->
  <rect x="650" y="300" width="230" height="50" class="step-box" rx="5"/>
  <text x="660" y="320" class="step-title">4. Permutation (P)</text>
  <text x="660" y="335" class="step-text">• Final 32-bit permutation</text>
  <text x="660" y="348" class="step-text">• Output of f function</text>

  <!-- Decryption -->
  <rect x="920" y="80" width="230" height="280" class="decryption-header" rx="10"/>
  <text x="1035" y="105" class="section-title">Decryption</text>

  <!-- Same Algorithm -->
  <rect x="940" y="120" width="190" height="60" class="step-box" rx="5"/>
  <text x="950" y="140" class="step-title">Same Algorithm</text>
  <text x="950" y="155" class="step-text">• Identical to encryption</text>
  <text x="950" y="168" class="step-text">• Keys used in reverse order</text>
  <text x="950" y="181" class="step-text">• K16, K15, ..., K1</text>

  <!-- Feistel Property -->
  <rect x="940" y="190" width="190" height="60" class="step-box" rx="5"/>
  <text x="950" y="210" class="step-title">Feistel Property</text>
  <text x="950" y="225" class="step-text">• Self-inverting structure</text>
  <text x="950" y="238" class="step-text">• Same hardware/software</text>
  <text x="950" y="251" class="step-text">• for encryption/decryption</text>

  <!-- Security Properties -->
  <rect x="940" y="260" width="190" height="90" class="step-box" rx="5"/>
  <text x="950" y="280" class="step-title">Security Properties</text>
  <text x="950" y="295" class="step-text">• Confusion via S-boxes</text>
  <text x="950" y="308" class="step-text">• Diffusion via permutations</text>
  <text x="950" y="321" class="step-text">• Avalanche effect</text>
  <text x="950" y="334" class="step-text">• Vulnerable to brute force</text>

  <!-- Detailed Algorithm Flow -->
  <rect x="50" y="380" width="1100" height="370" class="flow-bg" rx="10"/>
  <text x="600" y="405" class="title" style="font-size: 20px;">DES Algorithm Step-by-Step Flow</text>

  <!-- Input Processing -->
  <text x="150" y="435" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Input Processing</text>

  <!-- Plaintext -->
  <rect x="70" y="445" width="100" height="30" class="data-box" rx="3"/>
  <text x="120" y="465" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">Plaintext</text>
  <text x="120" y="480" style="font-family: Arial; font-size: 10px; fill: #2c3e50; text-anchor: middle;">(64 bits)</text>

  <!-- Initial Key -->
  <rect x="70" y="490" width="100" height="30" class="key-box" rx="3"/>
  <text x="120" y="510" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">Initial Key</text>
  <text x="120" y="525" style="font-family: Arial; font-size: 10px; fill: #2c3e50; text-anchor: middle;">(64 bits)</text>

  <!-- Processing Steps -->
  <rect x="200" y="445" width="80" height="40" fill="#e8f4fd" stroke="#3498db" rx="3"/>
  <text x="240" y="465" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Initial</text>
  <text x="240" y="480" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Permutation</text>

  <rect x="200" y="490" width="80" height="40" fill="#fde8e8" stroke="#e74c3c" rx="3"/>
  <text x="240" y="510" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">PC-1</text>
  <text x="240" y="525" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Permutation</text>

  <!-- Split Operations -->
  <rect x="310" y="445" width="60" height="30" fill="#fff3e0" stroke="#f39c12" rx="3"/>
  <text x="340" y="465" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">L0 (32)</text>

  <rect x="310" y="480" width="60" height="30" fill="#fff3e0" stroke="#f39c12" rx="3"/>
  <text x="340" y="500" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">R0 (32)</text>

  <rect x="310" y="515" width="60" height="30" fill="#fde8e8" stroke="#e74c3c" rx="3"/>
  <text x="340" y="535" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">C0, D0</text>

  <!-- Round Processing -->
  <text x="500" y="435" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Round Processing (16 iterations)</text>

  <!-- Feistel Round Box -->
  <rect x="420" y="445" width="160" height="100" fill="#f8f9fa" stroke="#6c757d" stroke-width="2" rx="5"/>
  <text x="500" y="465" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Feistel Round i</text>

  <text x="430" y="485" style="font-family: Arial; font-size: 10px; fill: #2c3e50;">1. Expansion: R → 48 bits</text>
  <text x="430" y="500" style="font-family: Arial; font-size: 10px; fill: #2c3e50;">2. XOR: E(R) ⊕ Ki</text>
  <text x="430" y="515" style="font-family: Arial; font-size: 10px; fill: #2c3e50;">3. S-Boxes: 48 → 32 bits</text>
  <text x="430" y="530" style="font-family: Arial; font-size: 10px; fill: #2c3e50;">4. Permutation P</text>

  <!-- Round Key Generation -->
  <rect x="420" y="555" width="160" height="40" fill="#fde8e8" stroke="#e74c3c" rx="3"/>
  <text x="500" y="575" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Ki Generation</text>
  <text x="500" y="590" style="font-family: Arial; font-size: 10px; fill: #2c3e50; text-anchor: middle;">Shift + PC-2</text>

  <!-- Output Processing -->
  <text x="750" y="435" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50;">Output Processing</text>

  <!-- Final Steps -->
  <rect x="670" y="445" width="80" height="40" fill="#e8f5e8" stroke="#27ae60" rx="3"/>
  <text x="710" y="465" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">R16, L16</text>
  <text x="710" y="480" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Concatenate</text>

  <rect x="670" y="495" width="80" height="40" fill="#e8f5e8" stroke="#27ae60" rx="3"/>
  <text x="710" y="515" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Final</text>
  <text x="710" y="530" style="font-family: Arial; font-size: 11px; fill: #2c3e50; text-anchor: middle;">Permutation</text>

  <!-- Ciphertext -->
  <rect x="770" y="470" width="100" height="30" class="data-box" rx="3"/>
  <text x="820" y="490" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">Ciphertext</text>
  <text x="820" y="505" style="font-family: Arial; font-size: 10px; fill: #2c3e50; text-anchor: middle;">(64 bits)</text>

  <!-- Flow Arrows -->
  <line x1="170" y1="460" x2="200" y2="460" class="arrow"/>
  <line x1="170" y1="505" x2="200" y2="505" class="arrow"/>
  <line x1="280" y1="460" x2="310" y2="460" class="arrow"/>
  <line x1="280" y1="505" x2="310" y2="530" class="arrow"/>
  <line x1="370" y1="480" x2="420" y2="480" class="arrow"/>
  <line x1="500" y1="555" x2="500" y2="545" class="arrow"/>
  <line x1="580" y1="480" x2="670" y2="465" class="arrow"/>
  <line x1="750" y1="485" x2="770" y2="485" class="arrow"/>

  <!-- S-Box Details -->
  <text x="600" y="620" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">S-Box Structure (Example: S1)</text>

  <!-- S-Box Table -->
  <rect x="400" y="635" width="400" height="80" fill="#fff3e0" stroke="#f39c12" rx="5"/>
  <text x="420" y="655" style="font-family: Arial; font-size: 11px; fill: #2c3e50;">Input: 6 bits (b1 b2 b3 b4 b5 b6)</text>
  <text x="420" y="670" style="font-family: Arial; font-size: 11px; fill: #2c3e50;">Row: b1b6 (outer bits) → 0-3</text>
  <text x="420" y="685" style="font-family: Arial; font-size: 11px; fill: #2c3e50;">Column: b2b3b4b5 (inner bits) → 0-15</text>
  <text x="420" y="700" style="font-family: Arial; font-size: 11px; fill: #2c3e50;">Output: 4-bit value from lookup table</text>

  <!-- Security Analysis -->
  <text x="600" y="735" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">DES Security Analysis</text>
  <text x="200" y="750" style="font-family: Arial; font-size: 12px; fill: #34495e; text-anchor: middle;">Strengths: Well-studied, standard</text>
  <text x="400" y="750" style="font-family: Arial; font-size: 12px; fill: #34495e; text-anchor: middle;">Weaknesses: 56-bit key vulnerable</text>
  <text x="600" y="750" style="font-family: Arial; font-size: 12px; fill: #34495e; text-anchor: middle;">Status: Superseded by AES</text>
  <text x="800" y="750" style="font-family: Arial; font-size: 12px; fill: #34495e; text-anchor: middle;">Legacy: Influenced modern ciphers</text>
  <text x="1000" y="750" style="font-family: Arial; font-size: 12px; fill: #34495e; text-anchor: middle;">Attacks: Brute force, linear</text>

  <!-- Footer -->
  <text x="600" y="780" class="subtitle">DES remains historically important but is no longer secure for modern cryptographic applications</text>
</svg>