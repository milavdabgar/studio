<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #2c3e50; text-anchor: middle; }
      .subtitle { font-family: Arial, sans-serif; font-size: 14px; fill: #34495e; text-anchor: middle; }
      .section-title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: white; text-anchor: middle; }
      .step-title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .step-text { font-family: Arial, sans-serif; font-size: 11px; fill: #34495e; }
      .formula-text { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; fill: #2c3e50; }
      .keygen-header { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .encryption-header { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .decryption-header { fill: #27ae60; stroke: #229954; stroke-width: 2; }
      .security-header { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .step-box { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 1; }
      .example-bg { fill: #f8f9fa; stroke: #6c757d; stroke-width: 1; }
      .formula-box { fill: #fff3e0; stroke: #f39c12; stroke-width: 1; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1200" height="800" fill="#ffffff"/>

  <!-- Title -->
  <text x="600" y="30" class="title">RSA Algorithm: Mathematical Foundation and Implementation</text>
  <text x="600" y="50" class="subtitle">Public Key Cryptography Based on Integer Factorization Problem</text>

  <!-- Key Generation -->
  <rect x="50" y="80" width="280" height="300" class="keygen-header" rx="10"/>
  <text x="190" y="105" class="section-title">Key Generation</text>

  <!-- Step 1: Prime Selection -->
  <rect x="70" y="120" width="240" height="55" class="step-box" rx="5"/>
  <text x="80" y="140" class="step-title">1. Select Two Large Primes</text>
  <text x="80" y="155" class="step-text">• Choose p and q (typically 512+ bits each)</text>
  <text x="80" y="168" class="step-text">• p ≠ q and both must be prime</text>

  <!-- Step 2: Compute n -->
  <rect x="70" y="185" width="240" height="40" class="step-box" rx="5"/>
  <text x="80" y="205" class="step-title">2. Compute n = p × q</text>
  <text x="80" y="220" class="step-text">• n is the modulus (public)</text>

  <!-- Step 3: Compute φ(n) -->
  <rect x="70" y="235" width="240" height="40" class="step-box" rx="5"/>
  <text x="80" y="255" class="step-title">3. Compute φ(n) = (p-1)(q-1)</text>
  <text x="80" y="270" class="step-text">• Euler's totient function</text>

  <!-- Step 4: Choose e -->
  <rect x="70" y="285" width="240" height="55" class="step-box" rx="5"/>
  <text x="80" y="305" class="step-title">4. Choose e (Public Exponent)</text>
  <text x="80" y="320" class="step-text">• 1 &lt; e &lt; φ(n)</text>
  <text x="80" y="333" class="step-text">• gcd(e, φ(n)) = 1 (coprime)</text>

  <!-- Step 5: Compute d -->
  <rect x="70" y="350" width="240" height="20" class="step-box" rx="5"/>
  <text x="80" y="365" class="step-title">5. Compute d ≡ e⁻¹ (mod φ(n))</text>

  <!-- Encryption -->
  <rect x="350" y="80" width="260" height="300" class="encryption-header" rx="10"/>
  <text x="480" y="105" class="section-title">Encryption Process</text>

  <!-- Public Key -->
  <rect x="370" y="120" width="220" height="55" class="step-box" rx="5"/>
  <text x="380" y="140" class="step-title">Public Key: (n, e)</text>
  <text x="380" y="155" class="step-text">• n: modulus (product of p and q)</text>
  <text x="380" y="168" class="step-text">• e: public exponent (commonly 65537)</text>

  <!-- Message Preparation -->
  <rect x="370" y="185" width="220" height="55" class="step-box" rx="5"/>
  <text x="380" y="205" class="step-title">Message Preparation</text>
  <text x="380" y="220" class="step-text">• Plaintext m: 0 ≤ m &lt; n</text>
  <text x="380" y="233" class="step-text">• Apply padding (PKCS#1, OAEP)</text>

  <!-- Encryption Formula -->
  <rect x="370" y="250" width="220" height="60" class="formula-box" rx="5"/>
  <text x="480" y="275" class="formula-text" style="text-anchor: middle;">Encryption Formula</text>
  <text x="480" y="295" class="formula-text" style="text-anchor: middle;">c = mᵉ mod n</text>
  <text x="380" y="310" class="step-text">• c: ciphertext</text>

  <!-- Security Properties -->
  <rect x="370" y="320" width="220" height="50" class="step-box" rx="5"/>
  <text x="380" y="340" class="step-title">Security Properties</text>
  <text x="380" y="355" class="step-text">• Based on factorization difficulty</text>
  <text x="380" y="368" class="step-text">• Semantic security with proper padding</text>

  <!-- Decryption -->
  <rect x="630" y="80" width="260" height="300" class="decryption-header" rx="10"/>
  <text x="760" y="105" class="section-title">Decryption Process</text>

  <!-- Private Key -->
  <rect x="650" y="120" width="220" height="55" class="step-box" rx="5"/>
  <text x="660" y="140" class="step-title">Private Key: (n, d)</text>
  <text x="660" y="155" class="step-text">• n: same modulus as public key</text>
  <text x="660" y="168" class="step-text">• d: private exponent (secret)</text>

  <!-- Decryption Formula -->
  <rect x="650" y="185" width="220" height="60" class="formula-box" rx="5"/>
  <text x="760" y="210" class="formula-text" style="text-anchor: middle;">Decryption Formula</text>
  <text x="760" y="230" class="formula-text" style="text-anchor: middle;">m = cᵈ mod n</text>
  <text x="660" y="245" class="step-text">• Recovers original message m</text>

  <!-- Mathematical Proof -->
  <rect x="650" y="255" width="220" height="75" class="step-box" rx="5"/>
  <text x="660" y="275" class="step-title">Mathematical Proof</text>
  <text x="660" y="290" class="step-text">• (mᵉ)ᵈ ≡ m (mod n)</text>
  <text x="660" y="303" class="step-text">• mᵉᵈ ≡ m (mod n)</text>
  <text x="660" y="316" class="step-text">• ed ≡ 1 (mod φ(n))</text>

  <!-- Key Security -->
  <rect x="650" y="340" width="220" height="30" class="step-box" rx="5"/>
  <text x="660" y="360" class="step-title">Key Security Requirements</text>

  <!-- Security Analysis -->
  <rect x="910" y="80" width="240" height="300" class="security-header" rx="10"/>
  <text x="1030" y="105" class="section-title">Security Analysis</text>

  <!-- Key Sizes -->
  <rect x="930" y="120" width="200" height="65" class="step-box" rx="5"/>
  <text x="940" y="140" class="step-title">Recommended Key Sizes</text>
  <text x="940" y="155" class="step-text">• 1024 bits: Deprecated</text>
  <text x="940" y="168" class="step-text">• 2048 bits: Current minimum</text>
  <text x="940" y="181" class="step-text">• 3072+ bits: Future-proof</text>

  <!-- Attack Methods -->
  <rect x="930" y="195" width="200" height="80" class="step-box" rx="5"/>
  <text x="940" y="215" class="step-title">Attack Methods</text>
  <text x="940" y="230" class="step-text">• Factorization attacks</text>
  <text x="940" y="243" class="step-text">• Chosen ciphertext attacks</text>
  <text x="940" y="256" class="step-text">• Side-channel attacks</text>
  <text x="940" y="269" class="step-text">• Timing attacks</text>

  <!-- Padding Schemes -->
  <rect x="930" y="285" width="200" height="65" class="step-box" rx="5"/>
  <text x="940" y="305" class="step-title">Secure Padding</text>
  <text x="940" y="320" class="step-text">• PKCS#1 v1.5 (legacy)</text>
  <text x="940" y="333" class="step-text">• OAEP (recommended)</text>
  <text x="940" y="346" class="step-text">• PSS (for signatures)</text>

  <!-- Performance -->
  <rect x="930" y="360" width="200" height="10" class="step-box" rx="5"/>

  <!-- Practical Example -->
  <rect x="50" y="400" width="1100" height="350" class="example-bg" rx="10"/>
  <text x="600" y="425" class="title" style="font-size: 20px;">RSA Implementation Example (Small Numbers)</text>

  <!-- Example Parameters -->
  <text x="200" y="455" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Key Generation Example</text>

  <!-- Step by step example -->
  <rect x="70" y="470" width="260" height="180" fill="#e8f4fd" stroke="#3498db" rx="5"/>
  <text x="80" y="490" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Step 1: Choose primes p = 61, q = 53</text>
  <text x="80" y="505" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Both are prime numbers</text>

  <text x="80" y="525" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Step 2: Compute n = p × q = 3233</text>
  <text x="80" y="540" style="font-family: Arial; font-size: 11px; fill: #34495e;">• n = 61 × 53 = 3233</text>

  <text x="80" y="560" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Step 3: Compute φ(n) = (p-1)(q-1)</text>
  <text x="80" y="575" style="font-family: Arial; font-size: 11px; fill: #34495e;">• φ(3233) = 60 × 52 = 3120</text>

  <text x="80" y="595" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Step 4: Choose e = 17</text>
  <text x="80" y="610" style="font-family: Arial; font-size: 11px; fill: #34495e;">• gcd(17, 3120) = 1 ✓</text>

  <text x="80" y="630" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Step 5: Compute d = 2753</text>
  <text x="80" y="645" style="font-family: Arial; font-size: 11px; fill: #34495e;">• 17 × 2753 ≡ 1 (mod 3120)</text>

  <!-- Encryption Example -->
  <text x="500" y="455" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Encryption Example</text>

  <rect x="370" y="470" width="260" height="110" fill="#fde8e8" stroke="#e74c3c" rx="5"/>
  <text x="380" y="490" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Public Key: (n=3233, e=17)</text>
  <text x="380" y="505" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Available to everyone</text>

  <text x="380" y="525" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Message: m = 123</text>
  <text x="380" y="540" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Must be &lt; n (3233)</text>

  <text x="380" y="560" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Encryption: c = 123¹⁷ mod 3233</text>
  <text x="380" y="575" style="font-family: Arial; font-size: 11px; fill: #34495e;">• c = 855</text>

  <!-- Decryption Example -->
  <rect x="370" y="590" width="260" height="60" fill="#e8f5e8" stroke="#27ae60" rx="5"/>
  <text x="380" y="610" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Private Key: (n=3233, d=2753)</text>
  <text x="380" y="625" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Secret, known only to recipient</text>

  <text x="380" y="645" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Decryption: m = 855²⁷⁵³ mod 3233 = 123 ✓</text>

  <!-- Implementation Considerations -->
  <text x="850" y="455" style="font-family: Arial; font-size: 16px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">Implementation</text>

  <rect x="720" y="470" width="260" height="180" fill="#f3e5f5" stroke="#9b59b6" rx="5"/>
  <text x="730" y="490" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Efficient Exponentiation</text>
  <text x="730" y="505" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Binary exponentiation algorithm</text>
  <text x="730" y="518" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Chinese Remainder Theorem</text>

  <text x="730" y="538" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Prime Generation</text>
  <text x="730" y="553" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Miller-Rabin primality test</text>
  <text x="730" y="566" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Cryptographically secure RNG</text>

  <text x="730" y="586" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Side-Channel Protection</text>
  <text x="730" y="601" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Constant-time operations</text>
  <text x="730" y="614" style="font-family: Arial; font-size: 11px; fill: #34495e;">• Blinding techniques</text>

  <text x="730" y="634" style="font-family: Arial; font-size: 12px; font-weight: bold; fill: #2c3e50;">Library Recommendations</text>
  <text x="730" y="649" style="font-family: Arial; font-size: 11px; fill: #34495e;">• OpenSSL, libgcrypt, Crypto++</text>

  <!-- Performance Comparison -->
  <text x="600" y="680" style="font-family: Arial; font-size: 14px; font-weight: bold; fill: #2c3e50; text-anchor: middle;">RSA vs Symmetric Cryptography</text>

  <rect x="100" y="690" width="200" height="30" fill="#fff3e0" stroke="#f39c12"/>
  <text x="200" y="710" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">RSA: Slow but flexible (key exchange)</text>

  <rect x="320" y="690" width="200" height="30" fill="#e8f4fd" stroke="#3498db"/>
  <text x="420" y="710" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">AES: Fast but needs shared key</text>

  <rect x="540" y="690" width="200" height="30" fill="#e8f5e8" stroke="#27ae60"/>
  <text x="640" y="710" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">Hybrid: RSA + AES (best of both)</text>

  <rect x="760" y="690" width="200" height="30" fill="#f3e5f5" stroke="#9b59b6"/>
  <text x="860" y="710" style="font-family: Arial; font-size: 12px; fill: #2c3e50; text-anchor: middle;">Use case: TLS handshake</text>

  <!-- Footer -->
  <text x="600" y="745" class="subtitle">RSA enables secure communication without prior key exchange but requires careful implementation for security</text>
</svg>